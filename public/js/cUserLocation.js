function UserLocation(){this.panel=new Popup("userlocation");this.panel.elem.find(".close").click(this.Close(this));this.panel.elem.find("#btnlocsearch").click(this.DoLocationSearch(this));this.panel.elem.find("#btngpssearch").click(this.DoGPSSearch(this))}
UserLocation.prototype.DoLocationSearch=function(a){return function(){window.clearInterval(locationTimer);var b=a.panel.elem.find("#loctext").val();DebugOut("getting coords for: "+b);(new google.maps.Geocoder).geocode({address:b},function(a,b){b==google.maps.GeocoderStatus.OK?HandleGeolocationQuery({coords:{latitude:a[0].geometry.location.lat(),longitude:a[0].geometry.location.lng()}}):alert("Could not find address: "+b)})}};
UserLocation.prototype.DoGPSSearch=function(a){return function(){window.clearInterval(locationTimer);userLocation=new google.maps.LatLng(0,0);QueryLocation();locationTimer=window.setInterval(QueryLocation,LOCATION_CK_INTERVAL)}};
UserLocation.prototype.Update=function(){var a="http://maps.googleapis.com/maps/api/staticmap?zoom=13&size=200x200&maptype=roadmap&markers=color:red%7Clabel:C%7C"+userLocation.lat()+","+userLocation.lng()+"&sensor=false";this.panel.elem.find(".locationmap").attr("src",a);this.panel.elem.find(".location span").html(userLocation.lat()+", "+userLocation.lng())};UserLocation.prototype.Close=function(a){return function(){a.panel.Hide();return!1}};UserLocation.prototype.Load=function(){this.Show()};
UserLocation.prototype.Show=function(){this.panel.Show();return!0};